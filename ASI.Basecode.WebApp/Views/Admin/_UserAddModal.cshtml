<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

@model ASI.Basecode.Services.ServiceModels.AdminCreateUserViewModel

@{
    ViewData["Title"] = "Add User Modal Page";
}

@if (ViewBag.NewUser != null)
{
    var user = ViewBag.NewUser;
    <div class="alert alert-success mt-3">
        <strong>New User Added:</strong><br />
        Email: @user.EmailId <br />
        Name: @user.FirstName @user.LastName <br />
        Role: @(user.Role == 0 ? "Admin" : "Guest")<br />
        @if (ViewBag.NewUserProfilePicture != null)
        {
            <img src="@ViewBag.NewUserProfilePicture" alt="Profile Picture" style="max-width:100px;max-height:100px;" />
        }
    </div>
}

<div id="addUserModal" class="fixed inset-0 z-50 flex hidden items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm">
    <div class="relative flex max-h-[700px] w-full max-w-6xl flex-row rounded-xl bg-[#640A16] shadow-lg">

        <!-- Left: Profile Upload UI -->
        <div class="flex w-[450px] flex-col items-center justify-center rounded-l-xl bg-white">
            <div class="absolute left-5 top-5">
                <a onclick="closeModal()" class="hover-pointer">
                    <span class="material-symbols-outlined text-[50px]">arrow_circle_left</span>
                </a>
            </div>

            <!-- Clickable Label for Upload -->
            <label for="profilePictureInput" class="mb-10 block h-[300px] w-[300px] cursor-pointer">
                <div class="flex h-full w-full items-center justify-center overflow-hidden rounded-3xl bg-[#FFE9C6]">
                    <img id="profilePreview" src="" alt="Preview" class="hidden h-full w-full rounded-3xl object-cover" />
                    <h1 id="plusSign" class="text-5xl">+</h1>
                </div>
            </label>

            <div class="flex flex-col items-center gap-5">
                <h1 id="previewName" class="text-2xl uppercase">New User</h1>
                <h2>Account Created: @DateTime.Now.ToString("MM/dd/yyyy")</h2>
            </div>
        </div>

        <!-- Right: Form -->
        <div class="flex-1 p-5">
            <h2 class="mb-4 text-2xl font-bold uppercase text-white">Create User</h2>

            <form id="createuserform" asp-action="CreateUser" asp-controller="Admin" method="post" enctype="multipart/form-data" class="space-y-4">
                <!-- File input must be inside the form -->
                <input id="profilePictureInput" name="ProfilePicture" type="file" accept="image/*" class="hidden" />

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">First Name</label>
                        <input asp-for="FirstName" id="firstName" class="w-[400px] rounded-xl border p-2" oninput="updatePreviewName()" />
                    </div>
                    <span asp-validation-for="FirstName" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Last Name</label>
                        <input asp-for="LastName" id="lastName" class="w-[400px] rounded-xl border p-2" oninput="updatePreviewName()" />
                    </div>
                    <span asp-validation-for="LastName" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Birthdate</label>
                        <input asp-for="Birthdate" type="date" class="w-[400px] rounded-xl border p-2" />
                    </div>
                    <span asp-validation-for="Birthdate" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Contact No.</label>
                        <input name="Contact" class="w-[400px] rounded-xl border p-2" />
                    </div>
                    <span asp-validation-for="Contact" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Email</label>
                        <input asp-for="EmailId" class="w-[400px] rounded-xl border p-2" />
                    </div>
                    <span asp-validation-for="EmailId" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Password</label>
                        <input asp-for="Password" type="password" class="w-[400px] rounded-xl border p-2" />
                    </div>
                    <span asp-validation-for="Password" class="block text-sm text-[#EAC231]"></span>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label class="w-32 text-white">Role</label>
                        <select asp-for="Role" class="w-[400px] rounded-xl border bg-[#EAC231] p-2 font-semibold text-black">
                            <option value="0">Admin</option>
                            <option value="1">Guest</option>
                            <option value="2">Superadmin</option>
                        </select>
                    </div>
                    <span asp-validation-for="Role" class="ml-32 block text-sm text-[#EAC231]"></span>
                </div>

                <div class="flex justify-center pt-4">
                    <button type="submit" class="w-[400px] rounded bg-[#FFE9C6] px-6 py-2 font-bold text-black">Add User</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- User Add Modal AJAX Script -->
<script src="~/js/useraddmodal_AJAX.js" asp-append-version="true"></script>
@await Html.PartialAsync("~/Views/Shared/_ValidationScriptsPartial.cshtml")